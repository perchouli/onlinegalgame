<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>添加故事</title>
<link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}css/style.css"/>
<style>
	input, textarea { display:block;}
	
	#hair_left, #cloth_left, #eye_left, #face_left, #glass_left, #other1_left, #other2_left, #other3_left {
		margin-left:30px;
	    width: 267px;
	    height: 400px;
	    position: absolute;
	    background-repeat: no-repeat;
	}
		#cloth_left {z-index: 3} 
		#hair_left {z-index: 4}
		#eye_left {z-index: 8}
		#face_left {z-index: 10;}

	#hair_right, #cloth_right, #eye_right, #face_right, #glass_right, #other1_right, #other2_right, #other3_right {
		margin-left:270px;
	    width: 267px;
	    height: 400px;
	    position: absolute;
	    background-repeat: no-repeat;
	}
		#cloth_right {z-index: 3} 
		#hair_right {z-index: 4}
		#eye_right {z-index: 8}
		#face_right {z-index: 10;}

	#glass {z-index: 7}
	#other1 {z-index: 7}
	#other2 {z-index: 7;}
	#other3 {z-index: 7;}
	
	#process_frame { width:200px;height:200px;background:#c6c6c6;overflow:hidden; text-overflow	:ellipsis; }
	#process_frame li:nth-child(odd) { background:#fff;text-overflow: ellipsis; }
</style>
</head>

<form id="story_form" action="{%url add_story %}" method="POST">
	{% csrf_token %}
	title:<input type="text" name="title" id="title"/>
	summary: <textarea id="summary" name="summary"></textarea>
	<input type="hidden" id="process" name="process" value="" />
	<p><input type="button" value="Submit" onclick="validator_story_from()"  /></p>
</form>

<div id="process_frame" data-type="test">

</div>

<script>
	function validator_story_from()
	{
				
		var process = document.querySelectorAll('#process_frame li');
		
		var process_value = [];
		for (var i=0 ;i < 5;i++)
		{
			process_value.join(process[i].dataset['type']);
		}
		alert (process_value);
		/*
		document.getElementById('story_form').submit();
		  */
		
		document.getElementById('process').value = process_value;
	}
	
	function add_dialog(id)
	{
		var  dia_content = document.getElementById('dialog_input').value;
		var el = document.getElementById('process_frame');
		el.innerHTML += '<li data-type="dialog" data-value="这里是内容">'+dia_content+'</li>';

	}
	
	function change_role( pos, value)
	{
		var role_dom = ['cloth_left', 'hair_left', 'face_left', 'eye_left'];
	
	
		var role_profile = [{{ role.profile|safe}}];
	
	for (var i in role_dom)
	{
		
		var el = document.getElementById(role_dom[i]);
		el.setAttribute("style",role_profile[i]);
	}	

	}	
</script>
<div>
对话：
<input id="dialog_input" type="text" /> <input type="button" value="添加对话" onclick="add_dialog(this.id)" />


左侧人物：
<select name="role" onchange="change_role(1,this.value)">
<option value="">未选择</option>
{% for role in role_list %}
	<option value="{{ role.id }}"> {{ role.name }}</option>
{% endfor %}
</select>

短袖：
<select name="cloth" onchange="change_role(this.name,this.value)">
	<option value="1">女仆装</option>
	<option value="2">女仆装</option>
	<option value="3">女仆装</option>
</select>
</div>

<div>
短发:
<select name="hair" onchange="change_role(this.name,this.value)">
	<option value="1">短发</option>
	<option value="2">女仆装</option>
	<option value="3">女仆装</option>
</select>

长发:
<select name="hair" onchange="change_role(this.name,this.value)">
	<option value="1">短发</option>
	<option value="2">女仆装</option>
	<option value="3">女仆装</option>
</select>
</div>
	<div id="role" style="background:url('{{ STATIC_URL }}bgd/mapback.jpg');margin-top:50px;width:500px;height:400px;border:1px solid #ccc;" >
		<div id="hair_left"></div>
		<div id="eye_left"></div>
		<div id="face_left"></div>
		<div id="cloth_left"></div>

	
		<div id="hair_right"></div>
		<div id="eye_right"></div>
		<div id="face_right"></div>
		<div id="cloth_right"></div>
	</div>
	<script>


	</script>